/**
 * Javascript Ajax
 * @author: Tom Flidr | tomflidr(at)gmail(dot)com
 * @url: https://github.com/tomFlidr/ajax.js
 * @version: 1.0
 * @date: 2015-10-11
 * @usage: basic example:
Ajax.load({
	url: 'https://github.com/tomFlidr',
	method: 'post',
	data: {
		anything: ["to", "serialize"]
	},
	success: function (data, statusCode, xhr) {
	},
	error: function (responseText, statusCode, xhr) {
	}
});
*/
var Ajax=function(){};Ajax.handlers={before:[],success:[],error:[]};Ajax.defaultHeaders={"X-Requested-With":"XmlHttpRequest","Content-Type":"application/x-www-form-urlencoded"};Ajax.K="AjaxJsonpCallback_";Ajax.J=0;Ajax.onBeforeLoad=function(a){Ajax.handlers.before.push(a)};Ajax.onLoadSuccess=function(a){Ajax.handlers.success.push(a)};Ajax.onLoadError=function(a){Ajax.handlers.error.push(a)};Ajax.get=function(){var a=new Ajax;return a.b.apply(a,[].slice.apply(arguments)).c()};Ajax.post=function(){var a=new Ajax;return a.b.apply(a,[].slice.apply(arguments)).c("post")};Ajax.load=function(a){var b=new Ajax;a.async="undefined"==typeof a.async?!0:a.async;return b.b(a.url,a.data,a.type,a.success,a.error,a.async).c(a.method)};Ajax.prototype={b:function(a,b,c,d,e,g,f){function h(){}this.url=a||"";this.data=b||{};this.type=(void 0===c?"":c).toLowerCase()||"";this.g=d||h;this.error=e||h;this.async="undefined"==typeof g?!0:g;this.headers=f||{};this.result={g:!0,data:{}};return this},c:function(a){return"jsonp"==this.type?this.H():this.I(a)},H:function(){var a=this,b=document,c=window,d=!!b.all,e=b.createElement("script"),b=a.B(),g=Ajax.K+Ajax.J++;c[g]=function(b){e.parentNode.removeChild(e);d?c[g]=void 0:delete c[g];a.i();a.result.data=b;a.g(b)};a.data.callback=g;a.j("get");e.setAttribute("src",a.url);a.h();e=d?b.insertAdjacentElement("beforeEnd",e):b.appendChild(e);return a},I:function(a){a=(void 0===a?"get":a).toLowerCase();var b=this,c=b.j(a);b.a=b.u();b.a.open(a,b.url,b.async);b.L();b.h();b.a.onreadystatechange=function(a){4==b.a.readyState&&b.D(a)};"get"==a?b.a.send():"post"==a&&b.a.send(c);return b},D:function(){var a=this.a;200==a.status?this.F():this.f(Error("Http Status Code: "+a.status));this.result.success||(this.m(),this.error(a.responseText,a.status,a))},F:function(){var a=this.a;0===this.type.length&&this.w();this.G();this.result.success&&(this.i(),this.g(this.result.data,a.status,a))},G:function(){var a=this.a;"json"==this.type?this.o():"xml"==this.type?this.s():"text"==this.type&&(this.result.data=a.responseText)},w:function(){var a=this.C();this.type="text";-1<a.indexOf("javascript")||-1<a.indexOf("json")?this.type="json":-1<a.indexOf("html")?this.type="html":-1<a.indexOf("xml")&&(this.type="xml")},C:function(){var a=this.A(),b=a.indexOf("/");-1<b&&(a=a.substr(b+1));return a},A:function(){var a=this.a.getResponseHeader("Content-Type"),b=a.indexOf(";"),a=0<a.length?a.toLowerCase():"";-1<b&&(a=a.substr(0,b));return a},o:function(){try{this.result.data=(new Function("return "+this.a.responseText))()}catch(a){this.f(a)}},s:function(){var a={},b=window,c=this.a.responseText,d=b.DOMParser;try{d?(a=new d,this.result.data=a.parseFromString(c,"application/xml")):(a=new b.ActiveXObject("Microsoft.XMLDOM"),a.async=!1,this.result.data=a.loadXML(c))}catch(e){this.f(e)}},u:function(){var a,b=window,c=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(b.XMLHttpRequest)a=new b.XMLHttpRequest;else for(var d=0,e=c.length;d<e;d+=1)try{a=new b.ActiveXObject(c[d])}catch(g){}return a},L:function(){var a=this.a,b=this.headers,c=Ajax.defaultHeaders,d;for(d in b)a.setRequestHeader(d,b[d]);for(d in c)b[d]||a.setRequestHeader(d,c[d])},j:function(a){var b="?",c=this.url,d=c.indexOf(b);a=a.toLowerCase();"get"==a?(this.data._=+new Date,a=this.l(),-1<d&&(b=d==c.length-1?"":"&"),this.url=c+b+a):a=this.l();return a},l:function(){var a=this.data,b=[],c,d=window,e;for(e in a)"object"==typeof a[e]?(d.JSON||this.v(),c=d.JSON.stringify(a[e])):c=a[e].toString(),b.push(e+"="+c);return b.join("&")},v:function(){window.JSON=function(){function a(a){return 10>a?"0"+a:a}function b(a,e){var g,f,h,k;g=/["\\\x00-\x1f\x7f-\x9f]/g;var l;switch(typeof a){case "string":return g.test(a)?'"'+a.replace(g,function(a){var b=c[a];if(b)return b;b=a.charCodeAt();return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)})+'"':'"'+a+'"';case "number":return isFinite(a)?String(a):"null";case "boolean":case "null":return String(a);case "object":if(!a)return"null";if("function"===typeof a.toJSON)return b(a.toJSON());g=[];if("number"===typeof a.length&&!a.propertyIsEnumerable("length")){k=a.length;for(f=0;f<k;f+=1)g.push(b(a[f],e)||"null");return"["+g.join(",")+"]"}if(e)for(k=e.length,f=0;f<k;f+=1)h=e[f],"string"===typeof h&&(l=b(a[h],e))&&g.push(b(h)+":"+l);else for(h in a)"string"===typeof h&&(l=b(a[h],e))&&g.push(b(h)+":"+l);return"{"+g.join(",")+"}"}}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z"};var c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:b,parse:function(a,b){function c(a,d){var f,m;if(d&&"object"===typeof d)for(f in d)Object.prototype.hasOwnProperty.apply(d,[f])&&(m=c(f,d[f]),void 0!==m&&(d[f]=m));return b(a,d)}var f;if(/^[\],:{}\s]*$/.test(a.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+a+")"),"function"===typeof b?c("",f):f;throw new SyntaxError("parseJSON");}}}()},B:function(){for(var a=document.body;null!==a.previousSibling&&void 0!==a.previousSibling&&(a=a.previousSibling,"head"!=a.nodeName.toLowerCase()););return a},h:function(){var a=Ajax.handlers.before,b="jsonp"==this.type,c;for(c in a)a[c](b?null:this.a)},i:function(){var a=Ajax.handlers.success,b="jsonp"==this.type,c;for(c in a)if(b)a[c](this.result.data,200,null);else a[c](this.result.data,this.a.status,this.a)},m:function(){var a=Ajax.handlers.error,b=this.a,c;for(c in a)a[c](b.responseText,b.status,b)},f:function(a){var b=window;this.result.success=!1;b.console&&b.console.log(a.stack,this.a)}};